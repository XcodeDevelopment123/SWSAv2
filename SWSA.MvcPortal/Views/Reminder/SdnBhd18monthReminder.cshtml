@{
    ViewData["Title"] = "SdnBhd18monthReminder";
}
<h1>Sdn Bhd first 18 months Reminder</h1>
<div class="row">
    <div class="col-md-12">
        <!-- /.card -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-bell me-2"></i>18 Months Reminder
                </h3>
                <div class="card-tools">
                    <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#taskModal">
                        <i class="fas fa-plus me-2"></i>New Task
                    </button>
                </div>
            </div>
            <!-- /.card-header -->
            <div class="card-body" style="overflow:auto">
                <table id="taskDatatable" class="table table-bordered table-striped table-responsive">
                    <thead>
                        <tr>
                            <th colspan="2">Admin</th>
                            <th colspan="4">Co Information</th>
                            <th colspan="2">Due Dates</th>
                            <th colspan="3">Reminder</th>
                        </tr>
                        <tr>
                            <th>Grouping</th>
                            <th>File</th>
                            <th>Company</th>
                            <th>Company Number</th>
                            <th>Incorporation Date</th>
                            <th>Year end</th>
                            <th>1st yr 18mths due date</th>
                            <th>Circulation & AFS due Date</th>
                            <th>Reminder date</th>
                            <th>Email Send</th>
                            <th>Date Send</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Group A</td>
                            <td>FILE-2023-001</td>
                            <td>TECH SOLUTIONS SDN BHD</td>
                            <td>202301012345</td>
                            <td>15/01/2023</td>
                            <td>31/12/2024</td>
                            <td>15/07/2024</td>
                            <td>31/10/2024</td>
                            <td>15/06/2024</td>
                            <td>Yes</td>
                            <td>15/06/2024</td>
                        </tr>
                        <tr>
                            <td>Group B</td>
                            <td>FILE-2023-002</td>
                            <td>GLOBAL TRADING SDN BHD</td>
                            <td>202302023456</td>
                            <td>20/02/2023</td>
                            <td>31/03/2024</td>
                            <td>20/08/2024</td>
                            <td>30/09/2024</td>
                            <td>20/07/2024</td>
                            <td>Yes</td>
                            <td>20/07/2024</td>
                        </tr>
                        <tr>
                            <td>Group A</td>
                            <td>FILE-2024-003</td>
                            <td>MEGA SERVICES SDN BHD</td>
                            <td>202403034567</td>
                            <td>10/03/2024</td>
                            <td>31/12/2025</td>
                            <td>10/09/2025</td>
                            <td>31/03/2026</td>
                            <td>10/08/2025</td>
                            <td>No</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- /.card-body -->
        </div>
        <!-- /.card -->
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="taskModal" tabindex="-1" aria-labelledby="taskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="taskModalLabel">
                    <i class="fas fa-edit me-2"></i>
                    <span id="modalTitle">Add New 18 Months Reminder</span>
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <input type="hidden" id="editIndex" value="">

                    <!-- Admin -->
                    <div class="form-info-label col-12">
                        <label>Admin</label>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="grouping">Grouping</label>
                                <input type="text" id="grouping" name="grouping" class="form-control" placeholder="Enter grouping" />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="file">File</label>
                                <input type="text" id="file" name="file" class="form-control" placeholder="Enter file number" />
                            </div>
                        </div>
                    </div>

                    <!-- Co Information -->
                    <div class="form-info-label col-12">
                        <label>Company Information</label>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="company">Company</label>
                                <input type="text" id="company" name="company" class="form-control" placeholder="Enter company name" />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="companyNumber">Company Number</label>
                                <input type="text" id="companyNumber" name="companyNumber" class="form-control" placeholder="Enter company number" />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="incorporationDate">Incorporation Date</label>
                                <input type="text" id="incorporationDate" name="incorporationDate" class="form-control" placeholder="Select date" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="yearEnd">Year end</label>
                                <input type="text" id="yearEnd" name="yearEnd" class="form-control" placeholder="Select date" />
                            </div>
                        </div>
                    </div>

                    <!-- Due Dates -->
                    <div class="form-info-label col-12">
                        <label>Due Dates</label>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="first18MonthsDue">1st yr 18mths due date</label>
                                <input type="text" id="first18MonthsDue" name="first18MonthsDue" class="form-control" placeholder="Select date" />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="circulationAfsDue">Circulation & AFS due Date</label>
                                <input type="text" id="circulationAfsDue" name="circulationAfsDue" class="form-control" placeholder="Select date" />
                            </div>
                        </div>
                    </div>

                    <!-- Reminder -->
                    <div class="form-info-label col-12">
                        <label>Reminder</label>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="reminderDate">Reminder date</label>
                                <input type="text" id="reminderDate" name="reminderDate" class="form-control" placeholder="Select date" />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="emailSend">Email Send</label>
                                <select id="emailSend" name="emailSend" class="form-control">
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="dateSend">Date Send</label>
                                <input type="text" id="dateSend" name="dateSend" class="form-control" placeholder="Select date" />
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>Cancel
                </button>
                <button type="button" class="btn btn-primary" id="saveBtn">
                    <i class="fas fa-save me-2"></i>Save
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        $(document).ready(function() {
            // Initialize date pickers for all date fields
            $('input[type="text"]').filter(function() {
                return $(this).attr('id') && (
                    $(this).attr('id').includes('Date') ||
                    $(this).attr('id').includes('date') ||
                    $(this).attr('id').includes('yearEnd')
                );
            }).datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true
            });

            // Auto-enable/disable Date Send based on Email Send selection
            $('#emailSend').on('change', function() {
                if ($(this).val() === 'No') {
                    $('#dateSend').val('-').prop('disabled', true);
                } else {
                    $('#dateSend').prop('disabled', false);
                    if ($('#dateSend').val() === '-') {
                        $('#dateSend').val('');
                    }
                }
            });

            // Initialize DataTable
            $('#taskDatatable').DataTable({
                responsive: true,
                ordering: true,
                autoWidth: false,
                pageLength: 10,
                order: [[8, 'asc']], // Sort by Reminder date
                language: {
                    search: "Search:",
                    lengthMenu: "Show _MENU_ entries"
                },
                columnDefs: [
                    {
                        targets: 9, // Email Send column
                        render: function(data, type, row) {
                            if (data === 'Yes') {
                                return '<span class="badge bg-success">Yes</span>';
                            } else {
                                return '<span class="badge bg-warning">No</span>';
                            }
                        }
                    }
                ]
            });

            // Save button click event
            $('#saveBtn').click(function() {
                // Here you would add save logic
                console.log('Save button clicked');
                $('#taskModal').modal('hide');
            });

            // Reset form when modal is closed
            $('#taskModal').on('hidden.bs.modal', function () {
                $('#taskForm')[0].reset();
                $('#editIndex').val('');
                $('#modalTitle').text('Add New 18 Months Reminder');
                $('#dateSend').prop('disabled', false);
            });
        });
    </script>
}