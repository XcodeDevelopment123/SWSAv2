
// <auto-generated />

using AutoMapper;
using Microsoft.Extensions.Caching.Memory;
using SWSA.MvcPortal.Commons.Constants;
using SWSA.MvcPortal.Entities;
using SWSA.MvcPortal.Repositories.Interfaces;
using SWSA.MvcPortal.Repositories.Repo;
using SWSA.MvcPortal.Services.Interfaces;

namespace SWSA.MvcPortal.Services;

public class DepartmentService(
IMemoryCache cache,
MemoryCacheEntryOptions cacheOptions,
IMapper mapper,
IDepartmentRepository repo
    ) : IDepartmentService
{


    private async Task<List<Department>> GetDepartmentsFromCacheAsync()
    {
        if (cache.TryGetValue(DataCacheKey.Departments, out List<Department>? dps))
        {
            return dps ?? [];
        }

        // Fetch data from the database or any other source
        dps = [.. await repo.GetAllAsync()];
        cache.Set(DataCacheKey.Departments, dps, cacheOptions);
        return dps;
    }

}
